# Nginx基本概念

**轻量级web服务**：nginx功能模块少，代码模块化，源代码仅保留http与核心模块代码，其余代码作为插件安装，便于二次开发

**nginx采用Epool网络模型，Apache采用Select模型**

**Select**：用户发起一次请求，select模型就会进行一次遍历扫描，导致性能低下

**Epool**：用户发起一次请求，epool模型会直接进行处理，效率高效，并无连接限制



### Nginx默认配置

Nginx主配置文件`/etc/nginx/nginx.conf`以区块的形式组织，每个区块以一对大括号`{}`表示开始与结束，主配置文件整体分为三块，分别是`Core Module (核心模块)`，`Event Module (事件驱动模块)`，`Http Core Module (http内核模块)`

---

示例：核心模块

```shell
user  nginx;								#nginx进程运行的用户
worker_processes  1;						#nginx工作的进程数量
error_log  /var/log/nginx/error.log warn;	#nginx的错误日志，warn表示警告类型，整体表示nginx记录警告或警告以上级别的错误日志
pid        /var/run/nginx.pid;				#进程运行ID
```

---

示例：事件驱动模块

```shell
events {
    worker_connections  1024;				#一个worker进程的最大连接数
    use epool;								#默认使用epool网络模型，可省略
}
```

---

示例：http内核模块

```shell
http {
    include       /etc/nginx/mime.types;		#包含资源文件类型
    default_type  application/octet-stream;		#默认返回类型，在mime.types中找不到对应文件类型时则返回此类型，直接将浏览器请求的文件下载到本地
	#日志格式定义，声明一个log_format的日志格式，将格式变量都保存到main中，使用时引入main即可
    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  /var/log/nginx/access.log  main; #访问日志，引用main

    sendfile        on;							#搞笑文件传输方式
    #tcp_nopush     on;

    keepalive_timeout  65;						#长连接尝试时间

    #gzip  on;									#压缩功能

    include /etc/nginx/conf.d/*.conf;
    server {									#定义一个网站
    	listen       80;						#监听端口
    	server_name  localhost;					#域名

    	#charset koi8-r;						#字符集
    	#access_log  /var/log/nginx/host.access.log  main; #访问日志
		#如果局部配置了访问日志则局部生效，否则http内核模块配置生效
    	location / {							#位置
        	root   /usr/share/nginx/html;		#代码主文件存放路径
        	index  index.html index.htm;		#默认返回index.html或index.htm
    	}
    }
}
```

---

> **补充**

`http{}`层下允许有多个`server{}`层，一个`server{}`层下允许有多个`location`

`http{}`标签主要用来解决用户的请求与响应

`server{}`标签主要用于响应具体的某个网站

`location{}`标签主要用于匹配网站具体URL路径



> **nginx静态web网站测试**

